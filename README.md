# NN_pytorch_BVP

Численное решение дифференциальных уравнений с помощью PINN

Для всех блокнотов из папки notebooks и скриптов из папки scripts расчитано, что **рабочая директория совпадает с корневой директорией проекта**

## Структура проекта
1) ***NN_pytorch_BVP*** — пакет с модулями, реализующими бизнес-логику проекта
2) ***notebooks*** — папка для блокнотов Jupyter, для разных численных экспериментов. Могут использовать код из пакета NN_pytorch_BVP
3) ***scripts*** — папка для разных маленьких скриптов, проверяющих отдельные моменты. Могут использовать код из пакета NN_pytorch_BVP
4) ***runs*** — папка для результатов запусков численных экспериментов
5) ***tests*** — для юнит-тестов бизнес-логики
6) ***data*** — доп. данные для экспериментов. Например, результаты численного решения задачи каким-нибудь другим методом

Модули NN_pytorch_BVP:

1) ***formatted_table.py*** — свой кастомный класс FormattedTable для возможности форматированного хранения метрик и удобного форматированного вывода их в терминал
2) ***bvp.py*** — модуль с иерархией для краевых задач (boundary value problems) и с рядом экземпляров конкретных краевых задач
3) ***pinn.py*** — модуль с реализацией нейросетей на pytorch
4) ***training.py*** — модуль с реализацией класса Coach, отвечающего за обучение нейросетей

## Настройка окружения
Проект разрабатывается с использованием версии *Python 3.13.7* с конкретными версиями пакетов, зафиксированных в *requirements.txt*. Это не принципиально, и можно использовать и другую версию Python, если под неё будут необходимые пакеты из *requirements.txt*

Рекомендуется разворачивать с применением виртуального окружения. 

Для работы на CPU: 

```bash
pip install -r requirements.txt
```

Для работы на GPU: 

```bash
pip install --extra-index-url https://download.pytorch.org/whl/cu130 -r requirements.txt
```

## Про рабочие и корневые директории

**Рабочая директория (working directory, CWD)** — папка, из которой запущен процесс Python. 

Например, если находиться в директории *"/"* и запустить скрипт, лежащий в *"/home/user"*, с содержимым

```python
from pathlib import Path
print(Path.cwd())
```

то в терминал выведется текущая рабочая директория: "/"

Проект расчитан на то, что процесс Python будет запущен из **корневой директории проекта** (той где лежит README.md)

Для скриптов, лежащих в директории *scripts* и *tests*, требуется добавить корневую директорию в path, чтобы была возможность импортировать модули из *NN_pytorch_BVP*:

```python
from pathlib import Path
import sys

ROOT = Path.cwd()  # корень проекта
if str(ROOT) not in sys.path:
    sys.path.insert(0, str(ROOT))
```

Для блокнотов Jupyter из папки *notebooks* требование такое же. В Visual Studio Code задать такое поведение можно на уровне среды разработки, создав в проекте файл *"./.vscode/settings.json"* с содержимым

```json
{
    "jupyter.notebookFileRoot": "\"${workspaceFolder}\""
}
```